var url_status,uploadFileHd,uploadFileWait;function pageAnchorsGenerate(e,b,c,f){var a="";for(var d=1;d<=e;d++){if(d==b){a+="<span>"+d+"</span>";}else{a+='<a page="'+d+'" class="pageChange">'+d+"</a>";
}}c=(c&&c!=="")?c:"#pager";$(c).html("").append(a).find(".pageChange").unbind("click").click(function(){f($(this).attr("page"),url_status);});$("#loading_row_init").remove();
}function set_date_param(b,a,c){$("#dateType").val(b);$("#startDate").val(a);$("#endDate").val(c);}function checkAll(b,a){$("input[name="+a+"]").prop("checked",$(b).prop("checked"));
}function checkAllAdSlot(b,a){if($(b).prop("checked")){if($("input[name="+a+"]:checked").length>0){$("input[name="+a+"]").not(":disabled").prop("checked",true);
}else{$(b).prop("checked",false);alert("操作错误!不能全选所有广告位!请先选择一个广告位!");}}else{$("input[name="+a+"]").prop("disabled",false).prop("checked",false).closest("tr").css({color:"black"});
}}function change(a,f,e,d,b){var c=$("input[name='"+a+"']:checked").map(function(){return $(this).val();}).get().join(",");if(c!==""){if(d.indexOf("delete")>-1){if(confirm("你确定需要删除当前选中项吗?")){globalChangeSubmit(f,e,d,c,a);
}}else{globalChangeSubmit(f,e,d,c,a);}}}function globalChangeSubmit(b,e,d,c,a){$.ajax({type:"GET",url:b,data:"ids="+c+"&paramName="+e+"&value="+d,success:function(f){refreshListAfterChange(e,d,c,a);
}});}function refreshListAfterChange(f,e,d,a){if(e.indexOf("delete")>-1){loadList(1);}else{var c=d.split(",");for(var b=0;b<c.length;b++){var g=c[b];if("status"==f&&e.indexOf("normal")>-1){$("#td_status_"+g).html("<img src='/images/icon_state_normal.gif' width='16' height='16' alt='正常' />正常").attr("status",e);
}else{if("status"==f&&e.indexOf("pause")>-1){$("#td_status_"+g).html("<img src='/images/icon_state_pause.gif' width='16' height='16' alt='暂停' />暂停").attr("status",e);
}}}if($("tr.expend_panel").length){var g=$("tr.expend_panel").prev().attr("id").replace("tr_","");adList.param.listUrl=adList.param.baseUrl+g;adList.loadList(adList.param.data.pageNo,$("tr.expend_panel").prev(),true);
}}}function list_datetype_change(d,b){if($("#dateType").val()!="Custom"){var a=new Date();if($("#dateType").val()=="Yesterday"){var c=new Date();c.setDate(a.getDate()-1);
$("#startDate").val(formatdate(c,"yyyy-MM-dd"));$("#endDate").val(formatdate(c,"yyyy-MM-dd"));}else{if($("#dateType").val()=="Today"){$("#startDate").val(formatdate(a,"yyyy-MM-dd"));
$("#endDate").val(formatdate(a,"yyyy-MM-dd"));}else{var e=new Date();e.setDate(a.getDate()-6);$("#startDate").val(formatdate(e,"yyyy-MM-dd"));$("#endDate").val(formatdate(a,"yyyy-MM-dd"));
}}change_querylink();d();}else{b();}}function list_updatebutton_click(d,b){var c=$("#startDate").val();var a=$("#endDate").val();if(c===""||a===""){alert("请输入日期范围！");
}else{$("#dateType").val("Custom");change_querylink();d();}}function change_querylink(){$(".queryLink").each(function(){var a=$(this).attr("href");if(a.indexOf("?")<0){a+="?";
}a=a.replace(/&dateType=[^&]*/,"");a=a.replace(/&startDate=[^&]*/,"");a=a.replace(/&endDate=[^&]*/,"");a=a+"&dateType="+$("#dateType").val();a=a+"&startDate="+$("#startDate").val();
a=a+"&endDate="+$("#endDate").val();$(this).attr("href",a);});}function intersectArray(c,b){var a=[];for(var d in c){a[d]=(c[d]&&b[d]);}return a;}$("tr td  a.changeIcon").click(function(){$(this).hide().next("span").hide().prevAll("input").show();
});function changeUploadStyle(b){var a=b||$('tr input[verify="file"]');a.each(function(c,d){$(d).siblings(".err").remove();if($(d).val()==""){$(d).prevAll("span,a").hide().filter("span").html("");
$(d).prevAll('input[type="file"]').show();}else{$(d).prevAll("span,a").show().filter("span").html('<a class="view_icon" target="_blank" href="'+$(d).val()+'">/upload/public/...</a>');
$(d).prevAll('input[type="file"]').hide();}});}function upload(g,f,b,h,e,a){if(g){if(verify_file($(g),$(g).attr("title"),$(g).attr("rule"),false,true)){function d(){uploadFileWait=true;
var i=$(e).attr("action");$(e+"_uploadType").val(f);$(e+"_fileObject").val(g.id);$(e+"_feedback").val(b);$(e+"_callback").val(h);$(e).attr("target","uploadFrame");
$(e).attr("action","/upload/uploadFile");$(e).submit();$(e).attr("target","_self");$(e).attr("action",i);}$(g).parent().append('<img id="loadingStatus" src="/images/roller.gif" width="25" height="25"/>');
if(a){var c=a.split("x");$(e+"_width").val(c[0]);$(e+"_height").val(c[1]);}if(!uploadFileWait){d();}else{uploadFileHd=setInterval(function(){if(uploadFileWait){return false;
}else{d();clearInterval(uploadFileHd);}},200);}}else{alert("请上传类型为"+$(g).attr("rule")+"的文件!大小不能超过"+$(g).attr("filesize")+"K");}}}function initUISelect(){$(".ui_select").unbind("click").click(function(){if($.browser.msie&&($.browser.version<"7.0")){if($(this).children(".pop_menu").height()>150){$(this).children(".pop_menu").css("height","144px");
}}$(this).children(".pop_menu").slideToggle(300);});$(".ui_select .pop_menu").delegate("ul li a","click",function(){$(this).parent().parent().parent().prev(".text").html($(this).html()).attr("title",$(this).html());
$('input[name="'+$(this).attr("pointto")+'"]').val($(this).attr("content")).trigger("change");});$(document).unbind("click").click(function(){$(".ui_select .pop_menu").hide();
});$(".ui_select").click(function(a){if(a.stopPropagation){a.stopPropagation();}else{a.cancelBubble=true;}});}function umengRadioImitate(){$(".radio_imitate").click(function(){$(".radio_imitate").removeClass("radio_imitate_checked");
$(this).addClass("radio_imitate_checked");});}function umengSelectIitate_withoutValue(){$(".select_imitate").click(function(){if($.browser.msie&&($.browser.version<"7.0")){if($(this).children(".pop_menu").height()>150){$(this).children(".pop_menu").css("height","144px");
}}if(!$(this).hasClass("disableShow")){$(this).children(".pop_menu").slideToggle(300);}});$(document).click(function(){$(".select_imitate .pop_menu").hide();
});$(".select_imitate").click(function(a){if(a.stopPropagation){a.stopPropagation();}else{a.cancelBubble=true;}});}function verify_null(f,b,c,g,e){var d={nul:true,num:"no",digits:"no",max:"no",min:"no",maxLength:"no",minLength:"no",fixLength:"no",url:"no"};
$.extend(d,e);var j={isNul:function(k){return k.replace(/(^\s*)|(\s*$)/g,"")!=""?{pass:true}:{pass:false,msg:"不能为空"};},isNumberic:function(k){return parseFloat(k)==k?{pass:true}:{pass:false,msg:"输入数字格式"};
},isDigit:function(k){return(parseInt(k)==k&&k>0)?{pass:true}:{pass:false,msg:"输入正整数"};},maxV:function(k,l){return parseInt(k)<=parseInt(l)?{pass:true}:{pass:false,msg:"不能大于 "+l};
},minV:function(l,k){return parseInt(l)>=k?{pass:true}:{pass:false,msg:"不能小于 "+k};},maxLength:function(l,k){return l.length<=k?{pass:true}:{pass:false,msg:"长度不能大于 "+k};
},minLength:function(l,k){return l.length>=k?{pass:true}:{pass:false,msg:"长度不能小于 "+k};},fixLength:function(l,k){return l.length==k?{pass:true}:{pass:false,msg:"固定长度为 "+k};
},url:function(l){var k=/^(http:|https:|telephone:|sdk:)\/\//ig;if(k.test(l)&&$.trim(l.replace(k,""))==""){return{pass:false,msg:"请输入正确的url"};}else{return{pass:true};
}}};var h=g?g:f,i={pass:true},a=f.val();if(a.indexOf("<")>-1||a.indexOf(">")>-1||a.indexOf("script")>-1||a.indexOf("eval")>-1){i={pass:false,msg:"字符不符合规则"};
}else{(function(){var l=["isNul","isNumberic","isDigit","maxV","minV","maxLength","minLength","fixLength","url"];var k=0;$.each(d,function(m,n){if(n!="no"&&i.pass){i=j[l[k]](a,n);
}k++;});})();}if(i.pass==false){f.parent().find(".err").remove();if(c){h.after("<div class='err'>"+i.msg+"</div>");}else{h.after("<span class='err'>"+i.msg+"</span>");
}f.focus();return false;}else{f.parent().find(".err").remove();return true;}}function verify_file(f,a,j,b,c){var g=new RegExp(j,"gi");if(!g.test(f.val())){if(f.parent().find(".err").length==0){if(!c){if(b){f.after("<div class='err'>"+a+"</div>");
}else{f.after("<span class='err'>"+a+"</span>");}}}f.focus();return false;}else{var i=false;if(f[0].files){i=(f[0].files[0].size/1024>parseInt(f.attr("filesize")));
}else{try{var d=new ActiveXObject("Scripting.FileSystemObject");i=(d.GetFile(f.val()).size/1024>parseInt(f.attr("filesize")));}catch(h){}}if(i){if(!c){if(f.parent().find(".err").html()==null){if(b){f.after("<div class='err'>文件不得大于"+f.attr("filesize")+"K</div>");
}else{f.after("<span class='err'>文件不得大于"+f.attr("filesize")+"K</span>");}}f.focus();}return false;}else{f.parent().find(".err").remove();return true;}}}function getToken(){return Math.random().toString(16).substring(2);
}$(function(){initUISelect();umengRadioImitate();umengSelectIitate_withoutValue();$(".part_operation dd a").click(function(){change("record_ch",$(this).attr("action")+"/changes?","status",$(this).attr("status"));
change("adStatusChange","/ad/changes?","status",$(this).attr("status"));return false;});$("#container").delegate(".state_panel li","click",function(a){a.stopPropagation();
if($(this).find("input").val()=="all"){if($(this).find("input").prop("checked")){$(".state_panel ul li").not(":last").find('input[type="checkbox"]').prop("checked",!$(this).find("input").prop("checked"));
}}else{$(".state_panel li:last").find("input").prop("checked",false);}});$("#container").delegate(".state","click",function(){if($(this).find(".state_panel").is(":hidden")){var a=parseInt($(this).width())+10;
$(this).addClass("show").find(".state_panel").width(a).show();}else{$(this).removeClass("show");$(this).find(".state_panel").hide();}});$("#container").delegate(".btn_change_state","click",function(c){c.stopPropagation();
var b=1,a=[{name:"正常",query:"normal"},{name:"应用暂停",query:"app_pause"},{name:"暂停",query:"pause"},{name:"到达预算",query:"limit"},{name:"订单暂停",query:"adorder_pause"},{name:"投放完成",query:"finish"},{name:"订单投放完成",query:"adorder_finish"},{name:"尚未投放",query:"ready"},{name:"订单尚未投放",query:"adorder_ready"},],d="";
url_status="";$(this).closest(".state").find(".state_panel li").not(":last").find("input[type='checkbox']:checked").each(function(){b=0;d+='<span class="'+$(this).siblings("label").attr("class")+'">'+a[$(this).val()].name+"</span>";
url_status+=("&status="+($(this).attr("pausetype")?($(this).attr("pausetype")+"_"):"")+a[$(this).val()].query);});if(b==1){d='<span class="none">未筛选</span>';
url_status="";}$(this).closest(".state").find(".state_info").html(d);$(this).closest(".state").removeClass("show");$(this).closest(".state").find(".state_panel").hide();
loadList(1,url_status);});});