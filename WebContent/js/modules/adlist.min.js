window.AdList=function(a){this.param={resultBody:"adPage",type:"get",listUrl:"adorder/showAd/",baseUrl:"adorder/showAd/",data:{},listTmpl:"#adList",listContainer:"tr.expend_panel div.tb_inner_wrap",special:"none"};
$.extend(this.param,a);};window.AdList.prototype={initUI:function(){var a=this;$("div.part_table").delegate("a.extend","click",function(){$(".extend").text("展开广告").removeClass("icon_expend").addClass("icon_expend_rev");
if($(this).parent().parent().next().attr("class")!="expend_panel"){$(this).text("收起广告").removeClass("icon_expend_rev").addClass("icon_expend");a.param.listUrl=a.param.baseUrl+$(this).closest("tr").attr("id").replace("tr_","");
a.loadList(1,$(this).closest("tr"));}else{$(this).text("展开广告").removeClass("icon_expend").addClass("icon_expend_rev");$(this).parent().parent().next().remove();
}});$("div.part_table").delegate("span.lvl","click",function(){var b=$(this).find("a").attr("adid");a.showPrior("td_level_"+b,b);});},tmplList:function(d){var c=this;
var b=d.totalPages;var a=d.pageNo;if(c.param.listTmpl.length>0){var e='<table class="tb_inner"><tbody><tr><th width="10"><input type="checkbox"  onclick="checkAll(this,&quot;adStatusChange&quot;)"></th><th width="160">广告名</th>';
if(c.param.special=="adslot"){e+="<th>订单</th>";}e+='<th width="110">类型</th><th width="110">优先级</th><th width="130">状态</th><th class="last" width="120">操作</th></tr><tr><td colspan="9" class="opr"><span class="btn_inner_table_new fl btn_add_ad"></span><div class=""><div id="ad_pager" class="fr pager"></div><div class="fl f_csv"></div></div></td></tr></tbody></table>';
$(c.param.listTmpl).tmpl(d.result,{checked:function(f){return(this.data.prior==f?"checked":"");},getId:function(){if(this.data.id){return this.data.id;
}else{return this.data.ad_id;}},getAdorders:function(){if(c.param.special=="adslot"){return'<td class="tb_adorder">'+(this.data.ad_order_name?this.data.ad_order_name:"-")+"</td>";
}else{return"";}},getType:function(){return(this.data.content_type=="app"?"应用推广":"网站推广");},getStatus:function(){var f="";if(c.param.baseUrl=="adorder/showAd/"){if(this.data.status=="normal"){f='<img src="images/icon_state_normal.gif" width="16" height="16" alt="正常" />正常';
}else{if(this.data.status=="pause"){f='<img src="images/icon_state_pause.gif" width="16" height="16" alt="暂停" />暂停';}else{if(this.data.status=="limit"){f='<img src="images/icon_state_top.gif" width="16" height="16" alt="到达预算" />到达预算';
}else{if(this.data.status=="adorder_pause"){f='<img src="images/icon_state_pause.gif" width="16" height="16" alt="订单暂停" />订单暂停';}else{if(this.data.status=="adorder_finish"){f='<img src="images/icon_state_complete.gif" width="16" height="16" alt="订单投放完成" />订单投放完成';
}else{if(this.data.status=="finish"){f='<img src="images/icon_state_complete.gif" width="16" height="16" alt="投放完成" />投放完成';}else{if(this.data.status=="adorder_ready"){f='<img src="images/icon_state_abled.gif" width="16" height="16" alt="订单尚未投放" />订单尚未投放';
}else{if(this.data.status=="ready"){f='<img src="images/icon_state_abled.gif" width="16" height="16" alt="尚未投放" />尚未投放';}else{f='<img src="images/icon_state_disabled.gif" width="16" height="16" alt="未知状态" />未知';
}}}}}}}}}else{if(this.data.ad_status=="normal"&&this.data.adslot_status=="normal"){f='<img src="images/icon_state_normal.gif" width="16" height="16" alt="正常" />正常';
}else{if(this.data.ad_status=="limit"&&this.data.adslot_status=="normal"){f='<img src="images/icon_state_top.gif" width="16" height="16" alt="到达预算" />到达预算';
}else{if(this.data.ad_status=="normal"&&this.data.adslot_status=="pause"){f='<img src="images/icon_state_pause.gif" width="16" height="16" alt="广告位暂停" />广告位暂停';
}else{if(this.data.ad_status=="pause"){f='<img src="images/icon_state_pause.gif" width="16" height="16" alt="广告暂停" />暂停';}else{if(this.data.ad_status=="adorder_pause"){f='<img src="images/icon_state_pause.gif" width="16" height="16" alt="订单暂停" />订单暂停';
}else{if(this.data.adslot_status=="app_pause"){f='<img src="images/icon_state_pause.gif" width="16" height="16" alt="应用暂停" />应用暂停';}else{if(this.data.ad_status=="adorder_finish"){f='<img src="images/icon_state_complete.gif" width="16" height="16" alt="订单投放完成" />订单投放完成';
}else{if(this.data.ad_status=="finish"){f='<img src="images/icon_state_complete.gif" width="16" height="16" alt="投放完成" />投放完成';}else{if(this.data.ad_status=="adorder_ready"){f='<img src="images/icon_state_abled.gif" width="16" height="16" alt="订单尚未投放" />订单尚未投放';
}else{if(this.data.ad_status=="ready"){f='<img src="images/icon_state_abled.gif" width="16" height="16" alt="尚未投放" />尚未投放';}else{f='<img src="images/icon_state_disabled.gif" width="16" height="16" alt="未知状态" />未知';
}}}}}}}}}}}return f;}}).insertAfter($(c.param.listContainer).html(e).find("table tr").first());pageAnchorsGenerate(b,a,"#ad_pager",function(f){c.loadList(f,$("tr.expend_panel").prev(),true);
});}},loadList:function(a,c,e){var d=this;var b=$(".expend_panel");d.param.data.rnd=Math.random();d.param.data.pageNo=a;$.ajax({type:d.param.type,url:d.param.listUrl,data:d.param.data,beforeSend:function(){if(!e){b.remove();
var f='<tr class="expend_panel"><td class="tb_inner" colspan="8" ><div class="tb_inner_wrap">加载中！</div></td></tr>';c.after(f);}},success:function(f,g){if(f[d.param.resultBody]){d.tmplList(f[d.param.resultBody]);
}},complete:function(f,g){},error:function(){$(d.param.listContainer).text("加载失败！");}});},showPrior:function(a,b){var c=this;$(".level .pnl").hide();var d=$("#"+a+".level .pnl");
if(d.next("span").hasClass("i1")){d.find("li").eq(0).find("input:radio").trigger("click");}else{if(d.next("span").hasClass("i2")){d.find("li").eq(1).find("input:radio").trigger("click");
}else{d.find("li").eq(2).find("input:radio").trigger("click");}}d.show();d.find(".btn_cancel").unbind("click").click(function(){$(".level .pnl").hide();
});d.find(".btn_save").unbind("click").click(function(){c.updatePrior("",b,"/ad/prior?prior="+$("#prior_input_"+b).val()+"&id="+b);});},updatePrior:function(b,a,c){$.ajax({type:"GET",url:c,data:"",success:function(d){$("#td_level_"+a+".level .pnl").hide();
$(".prior_img_"+a).removeClass("i1 i2 i3");$(".prior_img_"+a).addClass("i"+$("#prior_input_"+a).val());}});}};